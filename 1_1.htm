<html><body><div><div><div><div><div> <a href="https://habr.com?utm_source=tm_habrahabr&utm_medium=tm_top_panel&utm_campaign=tm_promo"> Хабр</a>  <a href="https://habr.com/flows/geektimes/"> Geektimes</a>  <a href="https://toster.ru?utm_source=tm_habrahabr&utm_medium=tm_top_panel&utm_campaign=tm_promo"> Тостер</a>  <a href="https://moikrug.ru?utm_source=tm_habrahabr&utm_medium=tm_top_panel&utm_campaign=tm_promo"> Мой круг</a>  <a href="https://freelansim.ru?utm_source=tm_habrahabr&utm_medium=tm_top_panel&utm_campaign=tm_promo"> Фрилансим</a> </div><div> Мегапосты:   </div></div></div></div><div><div><div><div>  <a href="https://habr.com/ru/"> </a>  <ul><li> <a href="https://habr.com/ru/"> Публикации</a> </li><li> <a href="https://habr.com/ru/news/"> Новости</a> </li><li> <a href="https://habr.com/ru/users/"> Пользователи</a> </li><li> <a href="https://habr.com/ru/hubs/"> Хабы</a> </li><li> <a href="https://habr.com/ru/companies/"> Компании</a> </li><li> <a href="https://habr.com/ru/sandbox/"> Песочница</a> </li></ul></div><div> <a href="https://habr.com/ru/tracker/">  189 </a>  <a href="https://habr.com/ru/topic/add/">  Написать </a> <div><img src="//habrastorage.org/getpro/habr/avatars/fd6/b22/2a2/fd6b222a22dc13f1a21c32c24a33b127.jpg"/><div> <a href="https://habr.com/ru/users/recompileme/">  recompileme <br/> Профиль </a> <br/> У&nbsp;вас<strong>93</strong>голоса за&nbsp;карму и&nbsp;публикации, и ещё<strong>186</strong>голосов за комментарии <ul><li> <a href="https://habr.com/ru/users/recompileme/posts/"> Публикации</a> </li><li> <a href="https://habr.com/ru/users/recompileme/posts/drafts/"> Черновики</a> </li><li> <a href="https://habr.com/ru/users/recompileme/comments/"> Комментарии</a> </li><li> <a href="https://habr.com/ru/conversations/"> Диалоги</a> </li><li> <a href="https://habr.com/ru/users/recompileme/favorites/"> Закладки</a> </li><li> <a href="https://habr.com/ru/beta/"> Бета-тестирование</a> </li><li> <a href="#"> </a> </li><li> <a href="https://habr.com/ru/auth/settings/profile/"> </a> </li><li> <a href="https://habr.com/ru/logout/recompileme/2634732228/"> </a> </li></ul></div></div></div></div></div></div><div><div><section><div><article><div><header> <a href="https://habr.com/ru/users/printf/"> <img src="//habrastorage.org/getpro/habr/avatars/71e/e48/5e6/71ee485e6c5cc740426c850b73a00eff.png"> printf </a>  26 апреля 2014 в 21:07 </header><h1> Readability своими руками </h1><ul><li> <a href="https://habr.com/ru/hub/javascript/"> JavaScript</a> ,</li><li> <a href="https://habr.com/ru/hub/algorithms/"> Алгоритмы</a> </li></ul><ul></ul><div><div><img src="https://habrastorage.org/getpro/habr/post_images/d83/22c/e16/d8322ce16ac2929781cb2f4062960382.jpg">Поскольку побеждать<s>Великий Китайский</s>Роскомнадзор наша <a href="https://hola.org"> штука для обхода блокировок в интернете</a> пока не особенно научилась, а рассказать что-нибудь странное про свою работу все равно хочется, расскажу про реимплементацию похожего на Readability алгоритма при помощи Node.js и<abbr>Бэйцзинского технологического института</abbr>.<br><br><h2>Что это вообще такое</h2><br>Readability — это радикальное продолжение идеи AdBlock убирать с веб-сайтов лишние элементы. Там, где AdBlock старается снести только самые бесполезные для пользователя вещи (в основном рекламу), Readability удаляет заодно скрипты, стили, навигацию и все остальное ненужное. Раньше такой вид страницы называли «версия для печати», хотя на самом-то деле текст предназначен для чтения (отсюда название Readability – «Удобочитаемость»).<br><br><h3>Лирическое отступление про парсеры</h3><br>Основная характеристика парсера сайтов, или других слабо структурированных форматов – это количество знаний о частных случаях использования формата в дикой природе.<br></a> <br><b>Вырожденный случай обладания всеми знаниями</b>– это парсер какого-то одного сайта. Т.е. если мы хотим воровать статьи с Хабрахабра, например, чтобы распечатывать их ночью на струйном принтере и приносить в жертву Сатане – мы можем посмотреть на существующую верстку и легко определить, что заголовок поста это<code>h1.title</code>.<br><br>Программа, написанная таким способом, почти не будет ошибаться; для каждого отличного от Хабрахабра сайта придется писать новую программу.<br><br><strong>Вырожденный идеальный случай:</strong>парсер вообще не знает, в каком формате он получил данные. Пример такой программы –<code>strings</code>(существует в большинстве неигровых операционных систем).<br><br>Если применить<code>strings</code>к какому-то не предназначенному для чтения файлу, можно получить список всего, что похоже на текст внутри этого файла. Например, команда<pre><code>strings `which ls`</code></pre>напечатает ворох строк для форматирования внутри бинарника<code>ls</code>, и справку.<br><br><pre><code>%e %b %T %Y 
%e %b %R 
usage: ls [-ABCFGHLOPRSTUWabcdefghiklmnopqrstuwx1] [file ...]</code></pre><br>Чем меньше знаний, тем универсальнее парсер.<br><br><h2>Что уже есть</h2><br>Исходники первой версии Readability <a href="https://code.google.com/p/arc90labs-readability/"> опубликованы</a> и являют собой леденящий душу клубок регулярных выражений. Это само по себе неплохо, но частные случаи просто аховые. Мне бы хотелось алгоритм, который обладает гораздо меньшими знаниями о популярных сайтах в интернете (см. выше, «лирическое отступление»).<br><br>Актуальная версия Readability закрыта и увешана плюшками разнообразной востребованности. Есть <a href="https://readability.com/developers/api"> API</a> .<br><br>Существует форк первой версии Readability компанией Apple (функция Reader в браузере Safari). Исходный код не очень-то открыт, но посмотреть на него можно, там еще больше регулярных выражений и частных случаев (например, есть такая переменная –<code>isWordPressSite</code>).<br><br>Проблемы оригинального скрипта – сложность модификации, аркадная эвристика. В основном работает, но требует нетривиальной доводки напильником. Версия Apple еще и лицензирована непонятно.<br><br><h2>Что надо написать</h2><br>Парсер сайтов, обладающий минимальными знаниями о разметке. Входные данные – одна страница сайта, или фрагмент страницы. Результат – текстовое представление входных данных.<br><br>Важный критерий – универсальность: программа будет работать и на клиенте, и на сервере. Поэтому мы не привязываемся к существующим реализациям DOM, а строим свою структуру данных (она еще и работает быстрее, чем полноценный DOM, т.к. данных нам нужно с гулькин, допустим, нос).<br><br>По этой же причине программа не будет уметь самостоятельно скачивать страницы из интернета, хранить результаты на диске, обладать пользовательским интерфейсом, вышивать крестиком.<br><br><h2>Жизнь и приключения алгоритма</h2><br>В поисковике нашлось несколько статей на тему алгоритмизации описанного выше процесса. Больше всего мне приглянулись <a href="http://disnet.cs.bit.edu.cn/DOM%20Based%20Content%20Extraction%20via%20Text%20Density.pdf"> вот эти китайцы<sup>PDF</sup></a> .<br><br>Формулы у меня получились немного другие, поэтому я расскажу кратенько про свой вариант китайского алгоритма.<br><br><strong>Для каждого тега в документе:</strong><br><ol><li><strong>Считаем оценку</strong><br><img src="https://habrastorage.org/getpro/habr/post_images/3ae/ecf/a3e/3aeecfa3ea7a7504ba69e01c86b25b26.png"><br>Здесь<em>chars</em>– количество текста (символов) внутри тега,<em>hyperchars</em>– количество текста в ссылках,<em>tags</em>– количество вложенных тегов (все метрики рекурсивные).</li><li><strong>Считаем сумму оценок</strong><br>Сумма оценок детей первого поколения (т.е. не рекурсивно).</li><li><strong>Нашли тег с максимальной суммой</strong><br>Это с высокой вероятностью контейнер основного текста. Или самый длинный комментарий. В любом случае там внутри буквы, это классно.</li></ol><br><h3>Простор для трудового подвига</h3><br>Дальше оптимизация. Я опишу несколько случаев, но вообще это самая интересная тема, можно в комментариях поболтать.<br><br><strong>Мусор в основном тексте.</strong>Всякие горе-блогеры любят прямо в тело поста засунуть многочисленные кнопки своих социальных вконтактов, твиттеров и т.п. ненужные вещи. У таких кнопок оценка<em>(score, см. выше)</em>стремится к нулю, по этому принципу их можно сносить.<br><br>Я на всякий случай проверяю еще, что после удаления мусора оценка родителя выросла, если нет (или выросла несущественно) – то не удаляю, мало ли что там.<br><br><strong>HTML.</strong>В алгоритме не используются знания о структуре документа, их можно теперь добавить, чтобы улучшить (или ускорить) работу программы. Т.е., допустим, пессимизировать заранее<code>&lt;footer&gt;</code>и<code>&lt;nav&gt;</code>, или добавлять к невидимым элементам (в браузере) аннотации и пропускать их совсем – тут реально простор для деятельности, я пока ничего не реализовал.<br><br><strong>Текстовые сигналы.</strong>Если в тексте присутствуют запятые, точки и другие знаки препинания, это с большой вероятностью связный текст (в отличие от навигации, например). Такая эвристика была в Readability.<br><br>Тут надо обратить внимание на то, что знаки препинания в разных языках все-таки разные, и запятые в китайском ("，" Unicode U+FF0C) отличаются от символа "," (ASCII 44).<br><br><h2>Что получилось, как пользоваться</h2><br>Результат я назвал незатейливо readability2, <a href="https://www.npmjs.org/package/readability2"> выложил в npm</a> .<br><br><h3>Кратенько про тесты</h3><br>Тестировать такую штуку надо обязательно, чтобы избежать регрессий (и вообще автоматически тестировать программы – это классно).<br><br>Тут возникает некая проблема: тест readability – это сохраненная страница совершенно постороннего сайта, плюс выдранный с нее же руками «эталонный» текст. Я не очень понимаю, как распространять это таким способом, чтобы правоторговцы не стремились меня уничтожить за незаконное копирование сайтов и текстов.<br><br>Если кто-то знает правильный ответ, напишите, пожалуйста, в комментариях. Сейчас тесты живут в закрытом репозитории, но им очень хочется на свободу.<br><br>Исходники без тестов: <a href="https://github.com/mvasilkov/readability2"> GitHib</a> <br><br><h3>Пример использования</h3><br>Для иллюстративных целей я написал страничку <a href="https://github.com/mvasilkov/readability2/blob/master/demo.html"> demo.html</a> , в которой две строки текста среди всякой навигации.<br><br>Текст называется «Название». Содержательная часть:<br><blockquote><em>Весь микрорайон тихонько чудо божье наблюдал:<br>Поп Игнатий тилибонькал свой церковный причиндал.</em></blockquote><div><b>(Public domain)</b><div>К слову, я отказываюсь от имущественных авторских прав на это литературное произведение, передавая его таким образом в общественное достояние (public domain). Распространять и использовать <a href="https://plus.google.com/+ReiAyanamiSuki/posts/NMLPbmpQsx5"> полный текст</a> теперь могут все без ограничений.</div></div><br>Таким должен быть результат прогона программы. Если результат не такой, значит, все сломалось.<br><br>А вот <a href="https://github.com/mvasilkov/readability2/blob/master/demo.js"> исходник программы demo.js</a> с комментариями. Используется парсер <a href="https://www.npmjs.org/package/sax"> sax</a> авторства <a href="https://github.com/isaacs"> Isaac Z. Schlueter</a> .<br><br><h3>Документация, она же API</h3><br><strong>Конструктор:</strong><br><br><pre><code>var reader = new Readability</code></pre><br>Ничего не принимает.<br><br><strong><abbr>SAX</abbr>интерфейс:</strong><br><br><pre><code>reader.onopentag(tagName)       // &lt;тег&gt;
reader.onattribute(name, value) // атрибут=значение
reader.ontext(text)             // текст
reader.onclosetag(tagName)      // &lt;/тег&gt;</code></pre><br>Тут все аргументы – строки.<br><br><strong>Чтобы получить результат:</strong><br><pre><code>var res = reader.compute(),
    text = reader.clean(res)</code></pre><br>На выходе:<code>res.heading</code>– название статьи и<code>text</code>– основной текст без форматирования.<br><br>Вместо<code>reader.clean</code>можно написать другой форматтер, тогда будет получаться не текст, а простая разметка, например.<br><br><h2>Вывод</h2><br><img src="https://habrastorage.org/getpro/habr/post_images/93b/4c9/f18/93b4c9f183417cd1fb2cae8bf6d6ded5.jpg">Программа работает. Ей пока немного страшно пользоваться, т.к. тестов всего около 20 штук, но я работаю над этим. Обновления будут. Патчи приветствуются, кроме всяких глупых. <a href="https://github.com/mvasilkov/readability2"> GitHub</a> . Лицензия MIT, я забыл ее залить в репозиторий.<br><br>Важное замечание: картинка слева не имеет никакого отношения к посту. Поэтому если она не загрузилась, и вы не видите слева никакой картинки – не расстраивайтесь.<br><br>Лучше напишите в комментариях, что вы обо всем этом думаете.</div></div><dl><dt>Теги:</dt><dd><ul><li> <a href="https://habr.com/ru/search/?q=%5Breadability%5D&target_type=posts"> readability</a> </li><li> <a href="https://habr.com/ru/search/?q=%5B%D0%B0%D0%BB%D0%B3%D0%BE%D1%80%D0%B8%D1%82%D0%BC%5D&target_type=posts"> алгоритм</a> </li><li> <a href="https://habr.com/ru/search/?q=%5Bnode.js%5D&target_type=posts"> node.js</a> </li><li> <a href="https://habr.com/ru/search/?q=%5Bsax%5D&target_type=posts"> sax</a> </li><li> <a href="https://habr.com/ru/search/?q=%5B%D0%BF%D0%B0%D1%80%D1%81%D0%B5%D1%80%5D&target_type=posts"> парсер</a> </li><li> <a href="https://habr.com/ru/search/?q=%5Bhtml%5D&target_type=posts"> html</a> </li></ul></dd></dl></div></article> Метки лучше разделять запятой. Например:<i>программирование, алгоритмы</i> <div></div></div><div><div><div><div><h3>Читают сейчас</h3></div><div><ul><li> <a href="https://habr.com/ru/post/452664/"> Я выставил счёт $18 000 за статичную веб-страничку… и мне это сошло с рук</a> <div>  74,3k   <a href="https://habr.com/ru/post/452664/#comments">  123 </a> </div></li><li> <a href="https://habr.com/ru/post/452760/"> Витамин Д. Пить или не пить, вот в чем вопрос. (Или рассказ о том, как я сдавал анализ, который мне не назначали)</a> <div>  9,9k   <a href="https://habr.com/ru/post/452760/#comments">  28 </a> </div></li><li> <a href="https://habr.com/ru/post/452492/"> Разбираем змею</a> <div>  4,4k   <a href="https://habr.com/ru/post/452492/#comments">  27 </a> </div></li><li> <a href="https://habr.com/ru/post/452128/"> Популярные заблуждения про радиационную стойкость микросхем</a> <div>  13,8k   <a href="https://habr.com/ru/post/452128/#comments">  18 </a> </div></li><li> <a href="https://habr.com/ru/post/452804/"> Я бросил работу мечты, потому что не переношу продуктовую разработку</a> <div>  2,5k   <a href="https://habr.com/ru/post/452804/#comments">  12 </a> </div></li><li> <a href="https://habr.com/ru/company/tuturu/blog/452690/"> Что там такого интересного в Транссибирской магистрали?</a> <div>  14,5k   <a href="https://habr.com/ru/company/tuturu/blog/452690/#comments">  62 </a> </div></li></ul></div></div></div></div></section><section><div><div><ul><li><div> +48 </div></li><li>  148  </li><li><div> 20,4k </div></li><li> <a href="https://habr.com/ru/post/220983/#comments">  13 </a> </li><li>  </li></ul><div> Указан только блог  Орфографические ошибки  Пунктуационные ошибки  Отступы  Текст-простыня  Короткие предложения  Смайлики  Много форматирования  Картинки  Ссылки  Оформление кода  Рекламный характер </div><div></div> Опишите суть нарушения <div></div><div><div><div><div> <a href="https://habr.com/ru/users/printf/"> <img src="//habrastorage.org/getpro/habr/avatars/71e/e48/5e6/71ee485e6c5cc740426c850b73a00eff.png"/></a> <div><div><div> <a href="https://habr.com/ru/info/help/karma/"> <div>108,2</div><div>Карма</div></a> </div></div> <a href="https://habr.com/ru/info/help/karma/#rating"> <div>0,0</div><div>Рейтинг</div></a>  <a href="https://habr.com/ru/users/printf/subscription/followers/"> <div>127</div><div>Подписчики</div></a> </div></div><div> <a href="https://habr.com/ru/conversations/printf/">   </a>  Подписан  Отписаться </div></div><div><div> <a href="https://habr.com/ru/users/printf/"> Рей</a> &nbsp; <a href="/users/printf/"> printf</a> </div><div>Девочка-волшебница</div></div><ul><li> <a href="http://mvasilkov.ovh/"> Сайт</a> </li></ul></div></div><div> Поделиться публикацией <ul><li> <a href="https://www.facebook.com/sharer/sharer.php?u=https://habr.com/ru/post/220983/"> </a> </li><li> <a href="https://twitter.com/intent/tweet?text=Readability+%D1%81%D0%B2%D0%BE%D0%B8%D0%BC%D0%B8+%D1%80%D1%83%D0%BA%D0%B0%D0%BC%D0%B8+https://habr.com/p/220983/+via+%40habr_com"> </a> </li><li> <a href="https://vk.com/share.php?url=https://habr.com/ru/post/220983/"> </a> </li><li> <a href="https://t.me/share/url?url=https://habr.com/ru/post/220983/&title=Readability своими руками"> </a> </li><li> <a href="https://getpocket.com/edit?url=https://habr.com/ru/post/220983/&title=Readability своими руками"> </a> </li></ul></div></div><div><div><h2>Похожие публикации</h2></div><div><ul><li> 19 апреля 2019 в 18:09 <h3> <a href="https://habr.com/ru/post/414541/"> Оптимизация node.js приложения</a> </h3><div>  +42    8k    145   <a href="https://habr.com/ru/post/414541#comments">  11 </a> </div></li><li> 30 января 2019 в 12:00 <h3> <a href="https://habr.com/ru/post/437984/"> Многопоточность в Node.js: модуль worker_threads</a> </h3><div>  +28    12,5k    119   <a href="https://habr.com/ru/post/437984#comments">  9 </a> </div></li><li> 14 января 2019 в 09:42 <h3> <a href="https://habr.com/ru/post/435970/"> Руководство для начинающих по серверной веб-разработке с Node.js</a> </h3><div>  +10    8k    117   <a href="https://habr.com/ru/post/435970#comments">  2 </a> </div></li></ul></div></div><div><div><h2> <a href="http://freelansim.ru"> Заказы</a>  <a href="http://freelansim.ru"> </a> </h2><div><ul><li> <a href="http://freelansim.ru/tasks/248299"> <div> Интегрировать виджет CDEK в сайт на Shopify (JS/PHP) <div> 0 откликов  4 просмотра </div></div><div><div> 6000 </div> за проект </div></a> </li><li> <a href="http://freelansim.ru/tasks/248287"> <div> Сделать сайт из шаблона на WP <div> 3 отклика  32 просмотра </div></div><div><div> 3000 </div> за проект </div></a> </li><li> <a href="http://freelansim.ru/tasks/248257"> <div> Из docx в html <div> 8 откликов  48 просмотров </div></div><div><div> 500 </div> за проект </div></a> </li><li> <a href="http://freelansim.ru/tasks/248225"> <div> Верстка дизайна лендинга и личного кабинета партнерской программы <div> 27 откликов  59 просмотров </div></div><div><div> 600 </div> за час </div></a> </li><li> <a href="http://freelansim.ru/tasks/248221"> <div> Верстка и оптимизация 35 страниц <div> 15 откликов  113 просмотров </div></div><div><div> 45000 </div> за проект </div></a> </li></ul></div><div> <a href="http://freelansim.ru/tasks/"> Все заказы</a>  <a href="http://freelansim.ru/info/pricing/"> Разместить заказ</a> </div></div></div></div><div></div></section><section><div><div><header><h2>Комментарии 13 </h2><div> Отслеживать новые в    почте  трекере   </div></header><ul><li>  <div>  <div> <a href="https://habr.com/ru/users/grossws/"> <img src="//habrastorage.org/r/w48/getpro/habr/avatars/be3/21c/e59/be321ce5998c10ffff4b20f0c5dd9862.jpg"/> grossws </a> <time>26 апреля 2014 в 22:15</time><ul><li> <a href="#comment_7536053"> </a> </li><li> <a href="#"> </a> </li><li> <a href="#comment_7536053"> </a> </li></ul><div> +4 </div></div><div>Как говорят в указанной вами статье, теоретическое обоснование приведено в статье «Boilerplate Detection using Shallow Text Features» (Christian Kohlschütter, Peter Fankhauser, Wolfgang Nejdl // inproc WSDM, 2010). Посмотреть на неё можно, например, тут: <a href="http://www.decom.ufop.br/menotti/rp122/sem/sem1-brayan-milton-art.pdf"> www.decom.ufop.br/menotti/rp122/sem/sem1-brayan-milton-art.pdf</a> .<br/><br/>Есть, например, <a href="http://code.google.com/p/boilerpipe/"> boilerpipe</a> , основанный на идеях вышеназванной статьи. Библиотека вполне рабочая.<br/><br/>Есть ещё онлайн-сервис выделения контента diffbot.com. Вполне нормальный, но цены у них поднялись последнее время. И триал получил ограничение на месяц.</div><div> <a href="#reply"> Ответить</a>  <a href="#abuse"> Пожаловаться</a> </div><div></div></div><ul><li>  <div>  <div> <a href="https://habr.com/ru/users/printf/"> <img src="//habrastorage.org/r/w48/getpro/habr/avatars/71e/e48/5e6/71ee485e6c5cc740426c850b73a00eff.png"/> printf </a> <time>26 апреля 2014 в 22:56</time><ul><li> <a href="#comment_7536155"> </a> </li><li> <a href="#"> </a> </li><li>  </li><li> <a href="#comment_7536053"> </a> </li><li> <a href="#comment_7536155"> </a> </li></ul><div> 0 </div></div><div>Именно boilerpipe сначала хотел использовать, но проблема – у меня Java в стеке нет.<br/>Несколько раз порывался разобраться в ней досконально и портировать “as is”, но так и не сделал.</div><div> <a href="#reply"> Ответить</a>  <a href="#abuse"> Пожаловаться</a> </div><div></div></div><ul></ul></li></ul></li><li>  <div>  <div> <a href="https://habr.com/ru/users/JIghtuse/">  JIghtuse </a> <time>26 апреля 2014 в 22:39</time><ul><li> <a href="#comment_7536109"> </a> </li><li> <a href="#"> </a> </li><li> <a href="#comment_7536109"> </a> </li></ul><div> +3 </div></div><div>Отлично, спасибо вам за статью и открытый исходник! Об используемых алгоритмах в таких сервисах не читал.<br/>Пользуюсь <a href="https://www.framabag.org/"> Framabag</a> , он делает примерно то же самое — Read-It-Later + выделение основного контента страницы. Тоже open source.</div><div> <a href="#reply"> Ответить</a>  <a href="#abuse"> Пожаловаться</a> </div><div></div></div><ul></ul></li><li>  <div>  <div> <a href="https://habr.com/ru/users/Zibx/"> <img src="//habrastorage.org/r/w48/getpro/habr/avatars/a4e/337/537/a4e33753758612f89ca3e271af50ee76.jpg"/> Zibx </a> <time>26 апреля 2014 в 22:54</time><ul><li> <a href="#comment_7536149"> </a> </li><li> <a href="#"> </a> </li><li> <a href="#comment_7536149"> </a> </li></ul><div> –3 </div></div><div>Блог должен быть облачным. Когда на одном домене число заходов приближается к 3к — домен резко меняется на другой, а на старом остаётся редирект. Можно проворачивать это с доменами седьмого уровня.</div><div> <a href="#reply"> Ответить</a>  <a href="#abuse"> Пожаловаться</a> </div><div></div></div><ul></ul></li><li>  <div>  <div> <a href="https://habr.com/ru/users/bak/"> <img src="//habrastorage.org/r/w48/getpro/habr/avatars/f1a/dba/c3e/f1adbac3ea3be738241838375a0bdd70.png"/> bak </a> <time>26 апреля 2014 в 23:14</time><ul><li> <a href="#comment_7536203"> </a> </li><li> <a href="#"> </a> </li><li> <a href="#comment_7536203"> </a> </li></ul><div> +1 </div></div><div>Пробовали как-то измерять качество? Для таких штук тесты ~ бесполезны. Обычно собирают крупный пул html страниц и соответствующего текста, а затем измеряют процент правильно извлечённого.<br/>Из готовых решений с хорошим качеством могу порекомендовать <a href="http://api.yandex.ru/rca/"> rich content api</a> яндекса.</div><div> <a href="#reply"> Ответить</a>  <a href="#abuse"> Пожаловаться</a> </div><div></div></div><ul><li>  <div>  <div> <a href="https://habr.com/ru/users/printf/"> <img src="//habrastorage.org/r/w48/getpro/habr/avatars/71e/e48/5e6/71ee485e6c5cc740426c850b73a00eff.png"/> printf </a> <time>26 апреля 2014 в 23:36</time><ul><li> <a href="#comment_7536245"> </a> </li><li> <a href="#"> </a> </li><li>  </li><li> <a href="#comment_7536203"> </a> </li><li> <a href="#comment_7536245"> </a> </li></ul><div> 0 </div></div><div>А почему бесполезны? Собираю руками разнообразные страницы и сравниваю, что получилось, с моими эталонными ожиданиями (т.е. с текстом, который я сам руками скопировал с этой страницы). В основном тесты проходят, а если не проходят, то скрипт подвергается насилию.<br/><br/>Получается достаточно интересно, ну и регрессии.<br/><br/>На самом деле надо бы потыкать датасет CleanEval, который по-моему все кроме меня применяют для этой цели.</div><div> <a href="#reply"> Ответить</a>  <a href="#abuse"> Пожаловаться</a> </div><div></div></div><ul><li>  <div>  <div> <a href="https://habr.com/ru/users/bak/"> <img src="//habrastorage.org/r/w48/getpro/habr/avatars/f1a/dba/c3e/f1adbac3ea3be738241838375a0bdd70.png"/> bak </a> <time>26 апреля 2014 в 23:43</time><ul><li> <a href="#comment_7536257"> </a> </li><li> <a href="#"> </a> </li><li>  </li><li> <a href="#comment_7536245"> </a> </li><li> <a href="#comment_7536257"> </a> </li></ul><div> +2 </div></div><div>Ну не то чтобы бесполезны… Просто при наличии большого количества примеров небольшие изменения в алгоритме начинают влиять на то, какие из тестов проходят а какие нет. Например, можно разучиться распознавать пять примеров но научиться двадцать. По мере роста пула скрипт подвергать насилию всё сложнее, особенно если вёрстка не идеальна.</div><div> <a href="#reply"> Ответить</a>  <a href="#abuse"> Пожаловаться</a> </div><div></div></div><ul></ul></li></ul></li><li>  <div>  <div> <a href="https://habr.com/ru/users/akira/"> <img src="//habrastorage.org/r/w48/getpro/habr/avatars/b95/865/5c7/b958655c7f3ec344460b5c00cf7e5877.png"/> akira </a> <time>27 апреля 2014 в 14:44</time><ul><li> <a href="#comment_7537049"> </a> </li><li> <a href="#"> </a> </li><li>  </li><li> <a href="#comment_7536203"> </a> </li><li> <a href="#comment_7537049"> </a> </li></ul><div> 0 </div></div><div>Я наверное не понимаю, как работает rich content api от Яндекса, но контент с habrahabr.ru или lenta.ru он отдает урезанный.</div><div> <a href="#reply"> Ответить</a>  <a href="#abuse"> Пожаловаться</a> </div><div></div></div><ul><li>  <div>  <div> <a href="https://habr.com/ru/users/akira/"> <img src="//habrastorage.org/r/w48/getpro/habr/avatars/b95/865/5c7/b958655c7f3ec344460b5c00cf7e5877.png"/> akira </a> <time>27 апреля 2014 в 14:50</time><ul><li> <a href="#comment_7537057"> </a> </li><li> <a href="#"> </a> </li><li>  </li><li> <a href="#comment_7537049"> </a> </li><li> <a href="#comment_7537057"> </a> </li></ul><div> 0 </div></div><div>Посмотрел внимательнее, это<u>выжимка</u>содержимого со страницы, а не само содержимое. Явно не замена readability.</div><div> <a href="#reply"> Ответить</a>  <a href="#abuse"> Пожаловаться</a> </div><div></div></div><ul><li>  <div>  <div> <a href="https://habr.com/ru/users/bak/"> <img src="//habrastorage.org/r/w48/getpro/habr/avatars/f1a/dba/c3e/f1adbac3ea3be738241838375a0bdd70.png"/> bak </a> <time>27 апреля 2014 в 21:10</time><ul><li> <a href="#comment_7537509"> </a> </li><li> <a href="#"> </a> </li><li>  </li><li> <a href="#comment_7537057"> </a> </li><li> <a href="#comment_7537509"> </a> </li></ul><div> 0 </div></div><div>Само содержимое. Выжимка в демке, в документации описан ключ full, например <a href="http://rca.yandex.com/?key=24LbkxMc&url=http://habrahabr.ru/company/hola/blog/220983/&full=1"> так</a> .</div><div> <a href="#reply"> Ответить</a>  <a href="#abuse"> Пожаловаться</a> </div><div></div></div><ul></ul></li></ul></li></ul></li></ul></li><li>  <div>  <div> <a href="https://habr.com/ru/users/RuJet/"> <img src="//habrastorage.org/r/w48/getpro/habr/avatars/947/766/1fd/9477661fd6372da383c60dfb86c921cd.png"/> RuJet </a> <time>27 апреля 2014 в 00:21</time><ul><li> <a href="#comment_7536309"> </a> </li><li> <a href="#"> </a> </li><li> <a href="#comment_7536309"> </a> </li></ul><div> +2 </div></div><div>Не смотрели как работает Clearly от Evernote? Это расширение для Google Chorme умеющий очищать страницу от лишних элементов.</div><div> <a href="#reply"> Ответить</a>  <a href="#abuse"> Пожаловаться</a> </div><div></div></div><ul><li>  <div>  <div> <a href="https://habr.com/ru/users/printf/"> <img src="//habrastorage.org/r/w48/getpro/habr/avatars/71e/e48/5e6/71ee485e6c5cc740426c850b73a00eff.png"/> printf </a> <time>27 апреля 2014 в 00:26</time><ul><li> <a href="#comment_7536319"> </a> </li><li> <a href="#"> </a> </li><li>  </li><li> <a href="#comment_7536309"> </a> </li><li> <a href="#comment_7536319"> </a> </li></ul><div> 0 </div></div><div>Только визуально. Анимации там классные.</div><div> <a href="#reply"> Ответить</a>  <a href="#abuse"> Пожаловаться</a> </div><div></div></div><ul></ul></li></ul></li><li>  <div>  <div> <a href="https://habr.com/ru/users/mihmig/"> <img src="//habrastorage.org/r/w48/getpro/habr/avatars/ef6/5ea/c20/ef65eac207e7d57c7056b1b03c561622.jpg"/> mihmig </a> <time>30 апреля 2014 в 14:57</time><ul><li> <a href="#comment_7548139"> </a> </li><li> <a href="#"> </a> </li><li> <a href="#comment_7548139"> </a> </li></ul><div> +2 </div></div><div>&gt;&gt;Пример такой программы – strings (существует в большинстве неигровых операционных систем).<br/>Как тонко… Оценил.</div><div> <a href="#reply"> Ответить</a>  <a href="#abuse"> Пожаловаться</a> </div><div></div></div><ul></ul></li></ul><div><div><div> Написать комментарий </div><div><div></div><div><ul><li></li><li></li><li></li><li></li><li></li><li></li><li><ul><li></li><li></li></ul></li><li></li><li></li><li></li><li></li><li></li></ul><div></div><div> Markdown
                            ( <a href="/info/help/markdown/"> ?</a> ) </div>  </div><div></div></div></div><div><h3>Ваш комментарий на модерации</h3><p>Он станет виден другим пользователям, если его одобрит автор поста или один из модераторов. Дальше вы сможете комментировать этот пост без ограничений.</p></div><div>  </div></div></div></div><div><div><div><div><h3>Что обсуждают</h3></div><div><ul><li> <a href="#broadcast_comments_now"> Сейчас</a> </li><li> <a href="#broadcast_comments_yesterday"> Вчера</a> </li><li> <a href="#broadcast_comments_week"> Неделя</a> </li></ul><div><ul><li> <a href="https://habr.com/ru/company/kingston_technology/blog/370267/"> Правда ли, что внутренние накопители смартфонов лучше любой карты памяти, и когда отправят на пенсию microSD?</a> <div>  64,5k   <a href="https://habr.com/ru/company/kingston_technology/blog/370267/#comments">  245 </a> </div></li><li> <a href="https://habr.com/ru/post/451286/"> Роскомнадзор, который мы заслужили</a> <div>  4,7k   <a href="https://habr.com/ru/post/451286/#comments">  72 </a> </div></li><li> <a href="https://habr.com/ru/news/t/452814/"> Стало известно реальное влияние Zombieload на производительность CPU</a> <div>  1,7k   <a href="https://habr.com/ru/news/t/452814/#comments">  7 </a> </div></li><li> <a href="https://habr.com/ru/post/452054/"> Почему WhatsApp никогда не станет безопасным</a> <div>  81,6k   <a href="https://habr.com/ru/post/452054/#comments">  713 </a> </div></li><li> <a href="https://habr.com/ru/post/452686/"> Шпионаж, за который не банят (история из 80-х)</a> <div>  18k   <a href="https://habr.com/ru/post/452686/#comments">  82 </a> </div></li></ul></div><div><ul><li> <a href="https://habr.com/ru/company/microsoft/blog/452338/"> Представляем Windows Terminal</a> <div>  55,5k   <a href="https://habr.com/ru/company/microsoft/blog/452338/#comments">  176 </a> </div></li><li> <a href="https://habr.com/ru/post/452664/"> Я выставил счёт $18 000 за статичную веб-страничку… и мне это сошло с рук</a> <div>  74,3k   <a href="https://habr.com/ru/post/452664/#comments">  123 </a> </div></li><li> <a href="https://habr.com/ru/post/452584/"> Заблуждения программистов о Unix-времени</a> <div>  32,7k   <a href="https://habr.com/ru/post/452584/#comments">  114 </a> </div></li><li> <a href="https://habr.com/ru/post/452686/"> Шпионаж, за который не банят (история из 80-х)</a> <div>  18k   <a href="https://habr.com/ru/post/452686/#comments">  82 </a> </div></li><li> <a href="https://habr.com/ru/post/451286/"> Роскомнадзор, который мы заслужили</a> <div>  4,7k   <a href="https://habr.com/ru/post/451286/#comments">  72 </a> </div></li></ul></div><div><ul><li> <a href="https://habr.com/ru/post/451982/"> Чем быстрее вы забудете ООП, тем лучше для вас и ваших программ</a> <div>  99,8k   <a href="https://habr.com/ru/post/451982/#comments">  868 </a> </div></li><li> <a href="https://habr.com/ru/post/452054/"> Почему WhatsApp никогда не станет безопасным</a> <div>  81,6k   <a href="https://habr.com/ru/post/452054/#comments">  713 </a> </div></li><li> <a href="https://habr.com/ru/post/451898/"> Инновации по-русски</a> <div>  91,8k   <a href="https://habr.com/ru/post/451898/#comments">  558 </a> </div></li><li> <a href="https://habr.com/ru/post/451812/"> Теперь хороших разрабов меряют по просмотрам и подписчикам — и это плохо</a> <div>  63,1k   <a href="https://habr.com/ru/post/451812/#comments">  411 </a> </div></li><li> <a href="https://habr.com/ru/company/madrobots/blog/452528/"> Илон Маск: если кардинально не урезать расходы, деньги у Tesla закончатся через 10 месяцев</a> <div>  42,5k   <a href="https://habr.com/ru/company/madrobots/blog/452528/#comments">  277 </a> </div></li></ul></div></div></div></div></section><div><div><section><div><div> Сообщить об ошибке </div><div></div><div><p>Выделен слишком большой фрагмент текста. Чтобы автору было легче понять в чем ошибка, выделите только проблемные слово или фразу или добавьте пояснение ниже.</p><p>Сообщение будет отправлено в ваш диалог с автором.</p><div></div><div></div></div></div></section></div></div></div></div><div><div><section><div><div><div><h2>Самое читаемое</h2></div><div><ul><li> <a href="#broadcast_posts_today"> Сутки</a> </li><li> <a href="#broadcast_posts_week"> Неделя</a> </li><li> <a href="#broadcast_posts_month"> Месяц</a> </li></ul><div><ul><li> <a href="https://habr.com/ru/post/452664/"> Я выставил счёт $18 000 за статичную веб-страничку… и мне это сошло с рук</a> <div>  &plus;175    74,3k    104   <a href="https://habr.com/ru/post/452664/#comments">  123 </a> </div></li><li> <a href="https://habr.com/ru/company/microsoft/blog/452338/"> Представляем Windows Terminal</a> <div>  &plus;102    55,5k    125   <a href="https://habr.com/ru/company/microsoft/blog/452338/#comments">  176 </a> </div></li><li> <a href="https://habr.com/ru/company/oleg-bunin/blog/450822/"> Исчезающие фреймворки</a> <div>  &plus;38    27,6k    124   <a href="https://habr.com/ru/company/oleg-bunin/blog/450822/#comments">  48 </a> </div></li><li> <a href="https://habr.com/ru/post/452686/"> Шпионаж, за который не банят (история из 80-х)</a> <div>  &plus;29    18k    29   <a href="https://habr.com/ru/post/452686/#comments">  82 </a> </div></li><li> <a href="https://habr.com/ru/post/452584/"> Заблуждения программистов о Unix-времени</a> <div>  &plus;72    32,7k    94   <a href="https://habr.com/ru/post/452584/#comments">  114 </a> </div></li></ul></div><div><ul><li> <a href="https://habr.com/ru/post/451982/"> Чем быстрее вы забудете ООП, тем лучше для вас и ваших программ</a> <div>  &plus;73    99,8k    409   <a href="https://habr.com/ru/post/451982/#comments">  868 </a> </div></li><li> <a href="https://habr.com/ru/post/451898/"> Инновации по-русски</a> <div>  &plus;422    91,8k    248   <a href="https://habr.com/ru/post/451898/#comments">  558 </a> </div></li><li> <a href="https://habr.com/ru/post/451860/"> Математики обнаружили идеальный способ перемножения чисел</a> <div>  &plus;150    90,7k    400   <a href="https://habr.com/ru/post/451860/#comments">  212 </a> </div></li><li> <a href="https://habr.com/ru/post/452238/"> Shit happens. Яндекс удалил часть виртуальных машин в своем облаке</a> <div>  &plus;107    89,1k    43   <a href="https://habr.com/ru/post/452238/#comments">  252 </a> </div></li><li> <a href="https://habr.com/ru/post/452054/"> Почему WhatsApp никогда не станет безопасным</a> <div>  &plus;157    81,6k    158   <a href="https://habr.com/ru/post/452054/#comments">  713 </a> </div></li></ul></div><div><ul><li> <a href="https://habr.com/ru/post/449060/"> Самый худший UI управления громкостью звука</a> <div>  &plus;262    159k    232   <a href="https://habr.com/ru/post/449060/#comments">  175 </a> </div></li><li> <a href="https://habr.com/ru/post/450266/"> Честное резюме программиста</a> <div>  &plus;366    144k    436   <a href="https://habr.com/ru/post/450266/#comments">  282 </a> </div></li><li> <a href="https://habr.com/ru/post/450294/"> Самые страшные яды</a> <div>  &plus;276    115k    475   <a href="https://habr.com/ru/post/450294/#comments">  609 </a> </div></li><li> <a href="https://habr.com/ru/post/451982/"> Чем быстрее вы забудете ООП, тем лучше для вас и ваших программ</a> <div>  &plus;73    99,8k    409   <a href="https://habr.com/ru/post/451982/#comments">  868 </a> </div></li><li> <a href="https://habr.com/ru/post/451898/"> Инновации по-русски</a> <div>  &plus;422    91,8k    248   <a href="https://habr.com/ru/post/451898/#comments">  558 </a> </div></li></ul></div></div></div></div><div><div><div><h2>Рекомендуем</h2> <a href="https://tmtm.ru/megapost"> Разместить</a> </div><div><ul><li> <a href="https://u.tmtm.ru/Bunin_SaintHighLoad2019_promo"> <img src="https://habrastorage.org/getpro/tmtm/pictures/1f4/2fa/28b/1f42fa28bd1f91aadb12e2b3736bd123.jpg"/></a>  <a href="https://u.tmtm.ru/Bunin_SaintHighLoad2019_promo"> <h3>Все приехали в Винтерфелл: спойлеры с конференции Saint HighLoad++ 2019</h3></a> </li><li> <a href="https://u.tmtm.ru/p-mts-p-290319"> <img src="https://habrastorage.org/getpro/tmtm/pictures/41d/114/bdc/41d114bdc15022888faa73437601ccd1.gif"/></a>  <a href="https://u.tmtm.ru/p-mts-p-290319"> <h3>Разбираемся как работает облачная миграция в #CloudМТS</h3></a> </li></ul></div></div></div></section></div></div><div><div><div><div><h3>recompileme</h3><div><ul><li> <a href="https://habr.com/ru/users/recompileme/"> Профиль</a> </li><li> <a href="https://habr.com/ru/tracker/"> Трекер</a> </li><li> <a href="https://habr.com/ru/conversations/"> Диалоги</a> </li><li> <a href="https://habr.com/ru/auth/settings/"> Настройки</a> </li><li> <a href="https://habr.com/ru/ppa/"> ППА</a> </li></ul></div></div><div><h3>Разделы</h3><div><ul><li> <a href="https://habr.com/ru/posts/top/"> Публикации</a> </li><li> <a href="https://habr.com/ru/news/"> Новости</a> </li><li> <a href="https://habr.com/ru/hubs/"> Хабы</a> </li><li> <a href="https://habr.com/ru/companies/"> Компании</a> </li><li> <a href="https://habr.com/ru/users/"> Пользователи</a> </li><li> <a href="https://habr.com/ru/sandbox/"> Песочница</a> </li></ul></div></div><div><h3>Информация</h3><div><ul><li> <a href="https://habr.com/ru/info/help/rules/"> Правила</a> </li><li> <a href="https://habr.com/ru/info/help/"> Помощь</a> </li><li> <a href="https://habr.com/ru/info/topics/madskillz/"> Документация</a> </li><li> <a href="https://account.habr.com/info/agreement/?hl=ru_RU"> Соглашение</a> </li><li> <a href="https://account.habr.com/info/confidential/?hl=ru_RU"> Конфиденциальность</a> </li></ul></div></div><div><h3>Услуги</h3><div><ul><li> <a href="https://tmtm.ru/services/advertising/"> Реклама</a> </li><li> <a href="https://tmtm.ru/services/corpblog/"> Тарифы</a> </li><li> <a href="https://tmtm.ru/services/content/"> Контент</a> </li><li> <a href="https://tmtm.ru/workshops/"> Семинары</a> </li></ul></div></div><div><h3>Приложения</h3><div> <a href="https://appmetrica.yandex.com/serve/240693928167260216?utm_source=HH_desktop&utm_medium=button&utm_campaign=appiOS"> </a>  <a href="https://appmetrica.yandex.com/serve/745097116363323173?id=ru.habrahabr&utm_source=HH_desktop&utm_medium=button&utm_campaign=appAndroid"> </a> </div></div></div><div>Если нашли опечатку в&nbsp;посте, выделите ее&nbsp;и&nbsp;нажмите Ctrl+Enter, чтобы сообщить автору.</div></div></div><div><div><div><div>   &copy; 2006 &ndash; 2019 « <a href="https://tmtm.ru/"> TM</a> » </div><div> <a href="#"> Настройка языка</a> </div><div> <a href="https://habr.com/ru/info/about/"> О сайте</a> </div><div> <a href="https://habr.com/ru/feedback/"> Служба поддержки</a> </div><div> <a href="https://m.habr.com/post/220983/?mobile=yes"> Мобильная версия</a> </div><div><ul><li> <a href="https://twitter.com/habr_com"> </a> </li><li> <a href="https://www.facebook.com/habrahabr.ru"> </a> </li><li> <a href="https://vk.com/habr"> </a> </li><li> <a href="https://telegram.me/habr_com"> </a> </li><li> <a href="https://www.youtube.com/channel/UCd_sTwKqVrweTt4oAKY5y4w"> </a> </li><li> <a href="https://zen.yandex.ru/habr"> </a> </li></ul></div></div></div></div> <a href="#"> </a> </div><div><div><div> Настройка языка </div><div><div> Русский </div><div> English </div><div> Русский </div><div> English </div><div></div></div></div></div></body></html>